<tool id="MrBayes" name="MrBayes (3.2.1)" version="3.2.1">
  <description>bayesian Inference of Phylogeny.</description>
  <parallelism method="basic"></parallelism>
  <command>
    module load mrbayes/3.2.1;
    cp $nexusfile $nexusfile.name;

    ###mrbayes $nexusfile.name > mrbayeslog;
    mpirun mrbayes-mpi $nexusfile.name > mrbayeslog;
    tar --exclude='*galaxy*' -cvf mrbayes_results.tar *
  </command>

  <requirements>
    <requirement type="binary">mrbayes</requirement>
  </requirements>

  <inputs>
    <param name="nexusfile" type="data" label="Input nexus file" help="" optional="false" format="nexus,nex" />
    <param name="jobname" type="text" label="Name your job" help="Default: MrBayes on input file" optional="true" format="txt" />
  </inputs>

  <outputs>
     <data format="txt" name="log1" from_work_dir="mrbayeslog" label="${jobname} - stdout">
       <filter>(jobname != "")</filter>
     </data>
     <data format="txt" name="log2" from_work_dir="mrbayeslog" label="MrBayes on ${nexusfile.name} - stdout">
       <filter>(jobname == "")</filter>
     </data>
     <data format="tar" name="allres1" from_work_dir="mrbayes_results.tar" label="${jobname} - all results">
       <filter>(jobname != "")</filter>
     </data>   
      <data format="tar" name="allres2" from_work_dir="mrbayes_results.tar" label="MrBayes on ${nexusfile.name} - all results">
       <filter>(jobname == "")</filter>
     </data>
  </outputs>

  <help>

**Job parameters**

MrBayes is an MPI applications - use > 1 for Number of CPUs


**About MrBayes**

MrBayes is a program for the Bayesian estimation of phylogeny. Bayesian inference of phylogeny is based upon a quantity called the posterior probability distribution of trees, which is the probability of a tree conditioned on the observations. The conditioning is accomplished using Bayes's theorem. The posterior probability distribution of trees is impossible to calculate analytically; instead, MrBayes uses a simulation technique called Markov chain Monte Carlo (or MCMC) to approximate the posterior probabilities of trees. 

**Home page**: http://mrbayes.sourceforge.net/

**Input**: File in nexus format

**Output**: Results "MrBayes results" are returned in a form of a tar file.  Use "tar xvf file_name" to extract. On windows, 7-zip (www.7-zip.org) can be used.

**Citation:**
Huelsenbeck, J. P. and F. Ronquist. 2001. MRBAYES: Bayesian inference of phylogeny. Bioinformatics 17:754-755.


Ronquist, F. and J. P. Huelsenbeck. 2003. MRBAYES 3: Bayesian phylogenetic inference under mixed models. Bioinformatics 19:1572-1574.


If you are using the MPI version of the program, you may also want to cite:
Altekar, G., S. Dwarkadas, J. P. Huelsenbeck, and F. Ronquist. 2004. Parallel Metropolis-coupled Markov chain Monte Carlo for Bayesian phylogenetic inference. Bioinformatics 20:407-415. 
                                    
  </help>
</tool>
